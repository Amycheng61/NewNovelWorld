2024-05-26 00:00:00,033 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id, user_id from author where create_time < ? order by create_time DESC limit ?
2024-05-26 00:00:00,041 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 2024-05-26 00:00:00.027(Timestamp), 10(Long)
2024-05-26 00:00:00,044 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,044 INFO (SQLLogger.java:71)- Logic SQL: select id, user_id from author where create_time < ? order by create_time DESC limit ?
2024-05-26 00:00:00,044 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=author, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[ItemsToken(isFirstOfItemsSpecial=false, items=[create_time AS ORDER_BY_DERIVED_0 ]), TableToken(skippedSchemaNameLength=0, originalLiterals=author)], parametersIndex=2)), containStar=false, selectListLastPosition=19, groupByLastPosition=0, items=[CommonSelectItem(expression=user_id, alias=Optional.absent()), CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[OrderItem(owner=Optional.absent(), name=Optional.of(create_time), orderDirection=DESC, nullOrderDirection=ASC, index=-1, alias=Optional.of(ORDER_BY_DERIVED_0))], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,045 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id, user_id , create_time AS ORDER_BY_DERIVED_0 from author where create_time < ? order by create_time DESC limit ? ::: [[2024-05-26 00:00:00.027, 10]]
2024-05-26 00:00:00,056 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 3
2024-05-26 00:00:00,058 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id, book_name from book where author_id = ?
2024-05-26 00:00:00,058 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 4(Long)
2024-05-26 00:00:00,059 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,060 INFO (SQLLogger.java:71)- Logic SQL: select id, book_name from book where author_id = ?
2024-05-26 00:00:00,060 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=book, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=book)], parametersIndex=1)), containStar=false, selectListLastPosition=21, groupByLastPosition=0, items=[CommonSelectItem(expression=book_name, alias=Optional.absent()), CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,060 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id, book_name from book where author_id = ? ::: [[4]]
2024-05-26 00:00:00,061 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 1
2024-05-26 00:00:00,067 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ?
2024-05-26 00:00:00,068 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1262260513468559363(Long), 2024-05-25 00:00:00.0(Timestamp), 2024-05-25 23:59:59.999(Timestamp)
2024-05-26 00:00:00,069 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,069 INFO (SQLLogger.java:71)- Logic SQL: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ?
2024-05-26 00:00:00,069 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=user_buy_record, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=user_buy_record)], parametersIndex=3)), containStar=false, selectListLastPosition=31, groupByLastPosition=0, items=[AggregationSelectItem(type=COUNT, innerExpression=(distinct user_id), alias=Optional.absent(), derivedAggregationSelectItems=[], index=-1)], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,069 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ? ::: [[1262260513468559363, 2024-05-25 00:00:00.0, 2024-05-25 23:59:59.999]]
2024-05-26 00:00:00,072 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 1
2024-05-26 00:00:00,074 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id from author_income_detail where book_id = ? and income_date = ?
2024-05-26 00:00:00,075 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1262260513468559363(Long), 2024-05-25(Date)
2024-05-26 00:00:00,075 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,076 INFO (SQLLogger.java:71)- Logic SQL: select id from author_income_detail where book_id = ? and income_date = ?
2024-05-26 00:00:00,076 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail)], parametersIndex=2)), containStar=false, selectListLastPosition=10, groupByLastPosition=0, items=[CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,076 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id from author_income_detail where book_id = ? and income_date = ? ::: [[1262260513468559363, 2024-05-25]]
2024-05-26 00:00:00,080 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 0
2024-05-26 00:00:00,095 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,096 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1681952053513478144(Long), 4(Long), 1262260513468559363(Long), 2024-05-25(Date), 0(Integer), 0(Integer), 0(Integer), 2024-05-26 00:00:00.082(Timestamp)
2024-05-26 00:00:00,108 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,110 INFO (SQLLogger.java:71)- Logic SQL: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,110 INFO (SQLLogger.java:71)- SQLStatement: InsertStatement(super=DMLStatement(super=AbstractSQLStatement(type=DML, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[AndCondition(conditions=[])])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail), io.shardingsphere.core.parsing.parser.token.InsertValuesToken@14f9c186], parametersIndex=8)), columns=[Column(name=user_id, tableName=author_income_detail), Column(name=author_id, tableName=author_income_detail), Column(name=book_id, tableName=author_income_detail), Column(name=income_date, tableName=author_income_detail), Column(name=income_account, tableName=author_income_detail), Column(name=income_count, tableName=author_income_detail), Column(name=income_number, tableName=author_income_detail), Column(name=create_time, tableName=author_income_detail)], generatedKeyConditions=[], insertValues=InsertValues(insertValues=[InsertValue(type=VALUES, expression=(?, ?, ?, ?, ?, ?, ?, ?), parametersCount=8)]), columnsListLastPosition=132, generateKeyColumnIndex=-1, insertValuesListLastPosition=165)
2024-05-26 00:00:00,110 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?) ::: [[1681952053513478144, 4, 1262260513468559363, 2024-05-25, 0, 0, 0, 2024-05-26 00:00:00.082]]
2024-05-26 00:00:00,115 DEBUG (BaseJdbcLogger.java:137)- <==    Updates: 1
2024-05-26 00:00:00,116 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ?
2024-05-26 00:00:00,116 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 4(Long), 0(Long), 2024-05-25(Date)
2024-05-26 00:00:00,117 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,118 INFO (SQLLogger.java:71)- Logic SQL: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ?
2024-05-26 00:00:00,118 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail)], parametersIndex=3)), containStar=false, selectListLastPosition=10, groupByLastPosition=0, items=[CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,119 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ? ::: [[4, 0, 2024-05-25]]
2024-05-26 00:00:00,121 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 0
2024-05-26 00:00:00,122 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,124 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1681952053513478144(Long), 4(Long), 0(Long), 2024-05-25(Date), 0(Integer), 0(Integer), 0(Integer), 2024-05-26 00:00:00.122(Timestamp)
2024-05-26 00:00:00,124 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,124 INFO (SQLLogger.java:71)- Logic SQL: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,125 INFO (SQLLogger.java:71)- SQLStatement: InsertStatement(super=DMLStatement(super=AbstractSQLStatement(type=DML, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[AndCondition(conditions=[])])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail), io.shardingsphere.core.parsing.parser.token.InsertValuesToken@14f9c186], parametersIndex=8)), columns=[Column(name=user_id, tableName=author_income_detail), Column(name=author_id, tableName=author_income_detail), Column(name=book_id, tableName=author_income_detail), Column(name=income_date, tableName=author_income_detail), Column(name=income_account, tableName=author_income_detail), Column(name=income_count, tableName=author_income_detail), Column(name=income_number, tableName=author_income_detail), Column(name=create_time, tableName=author_income_detail)], generatedKeyConditions=[], insertValues=InsertValues(insertValues=[InsertValue(type=VALUES, expression=(?, ?, ?, ?, ?, ?, ?, ?), parametersCount=8)]), columnsListLastPosition=132, generateKeyColumnIndex=-1, insertValuesListLastPosition=165)
2024-05-26 00:00:00,125 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?) ::: [[1681952053513478144, 4, 0, 2024-05-25, 0, 0, 0, 2024-05-26 00:00:00.122]]
2024-05-26 00:00:00,128 DEBUG (BaseJdbcLogger.java:137)- <==    Updates: 1
2024-05-26 00:00:00,130 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id, book_name from book where author_id = ?
2024-05-26 00:00:00,130 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 3(Long)
2024-05-26 00:00:00,130 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,132 INFO (SQLLogger.java:71)- Logic SQL: select id, book_name from book where author_id = ?
2024-05-26 00:00:00,132 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=book, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=book)], parametersIndex=1)), containStar=false, selectListLastPosition=21, groupByLastPosition=0, items=[CommonSelectItem(expression=book_name, alias=Optional.absent()), CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,133 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id, book_name from book where author_id = ? ::: [[3]]
2024-05-26 00:00:00,134 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 1
2024-05-26 00:00:00,136 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ?
2024-05-26 00:00:00,136 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1262260513468559362(Long), 2024-05-25 00:00:00.0(Timestamp), 2024-05-25 23:59:59.999(Timestamp)
2024-05-26 00:00:00,137 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,137 INFO (SQLLogger.java:71)- Logic SQL: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ?
2024-05-26 00:00:00,137 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=user_buy_record, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=user_buy_record)], parametersIndex=3)), containStar=false, selectListLastPosition=31, groupByLastPosition=0, items=[AggregationSelectItem(type=COUNT, innerExpression=(distinct user_id), alias=Optional.absent(), derivedAggregationSelectItems=[], index=-1)], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,137 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ? ::: [[1262260513468559362, 2024-05-25 00:00:00.0, 2024-05-25 23:59:59.999]]
2024-05-26 00:00:00,139 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 1
2024-05-26 00:00:00,140 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id from author_income_detail where book_id = ? and income_date = ?
2024-05-26 00:00:00,140 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1262260513468559362(Long), 2024-05-25(Date)
2024-05-26 00:00:00,141 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,141 INFO (SQLLogger.java:71)- Logic SQL: select id from author_income_detail where book_id = ? and income_date = ?
2024-05-26 00:00:00,143 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail)], parametersIndex=2)), containStar=false, selectListLastPosition=10, groupByLastPosition=0, items=[CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,143 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id from author_income_detail where book_id = ? and income_date = ? ::: [[1262260513468559362, 2024-05-25]]
2024-05-26 00:00:00,144 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 0
2024-05-26 00:00:00,145 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,145 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1681866976364371968(Long), 3(Long), 1262260513468559362(Long), 2024-05-25(Date), 0(Integer), 0(Integer), 0(Integer), 2024-05-26 00:00:00.144(Timestamp)
2024-05-26 00:00:00,146 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,146 INFO (SQLLogger.java:71)- Logic SQL: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,146 INFO (SQLLogger.java:71)- SQLStatement: InsertStatement(super=DMLStatement(super=AbstractSQLStatement(type=DML, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[AndCondition(conditions=[])])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail), io.shardingsphere.core.parsing.parser.token.InsertValuesToken@14f9c186], parametersIndex=8)), columns=[Column(name=user_id, tableName=author_income_detail), Column(name=author_id, tableName=author_income_detail), Column(name=book_id, tableName=author_income_detail), Column(name=income_date, tableName=author_income_detail), Column(name=income_account, tableName=author_income_detail), Column(name=income_count, tableName=author_income_detail), Column(name=income_number, tableName=author_income_detail), Column(name=create_time, tableName=author_income_detail)], generatedKeyConditions=[], insertValues=InsertValues(insertValues=[InsertValue(type=VALUES, expression=(?, ?, ?, ?, ?, ?, ?, ?), parametersCount=8)]), columnsListLastPosition=132, generateKeyColumnIndex=-1, insertValuesListLastPosition=165)
2024-05-26 00:00:00,146 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?) ::: [[1681866976364371968, 3, 1262260513468559362, 2024-05-25, 0, 0, 0, 2024-05-26 00:00:00.144]]
2024-05-26 00:00:00,149 DEBUG (BaseJdbcLogger.java:137)- <==    Updates: 1
2024-05-26 00:00:00,151 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ?
2024-05-26 00:00:00,151 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 3(Long), 0(Long), 2024-05-25(Date)
2024-05-26 00:00:00,151 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,152 INFO (SQLLogger.java:71)- Logic SQL: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ?
2024-05-26 00:00:00,152 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail)], parametersIndex=3)), containStar=false, selectListLastPosition=10, groupByLastPosition=0, items=[CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,152 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ? ::: [[3, 0, 2024-05-25]]
2024-05-26 00:00:00,154 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 0
2024-05-26 00:00:00,155 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,156 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1681866976364371968(Long), 3(Long), 0(Long), 2024-05-25(Date), 0(Integer), 0(Integer), 0(Integer), 2024-05-26 00:00:00.155(Timestamp)
2024-05-26 00:00:00,156 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,156 INFO (SQLLogger.java:71)- Logic SQL: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,157 INFO (SQLLogger.java:71)- SQLStatement: InsertStatement(super=DMLStatement(super=AbstractSQLStatement(type=DML, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[AndCondition(conditions=[])])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail), io.shardingsphere.core.parsing.parser.token.InsertValuesToken@14f9c186], parametersIndex=8)), columns=[Column(name=user_id, tableName=author_income_detail), Column(name=author_id, tableName=author_income_detail), Column(name=book_id, tableName=author_income_detail), Column(name=income_date, tableName=author_income_detail), Column(name=income_account, tableName=author_income_detail), Column(name=income_count, tableName=author_income_detail), Column(name=income_number, tableName=author_income_detail), Column(name=create_time, tableName=author_income_detail)], generatedKeyConditions=[], insertValues=InsertValues(insertValues=[InsertValue(type=VALUES, expression=(?, ?, ?, ?, ?, ?, ?, ?), parametersCount=8)]), columnsListLastPosition=132, generateKeyColumnIndex=-1, insertValuesListLastPosition=165)
2024-05-26 00:00:00,157 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?) ::: [[1681866976364371968, 3, 0, 2024-05-25, 0, 0, 0, 2024-05-26 00:00:00.155]]
2024-05-26 00:00:00,160 DEBUG (BaseJdbcLogger.java:137)- <==    Updates: 1
2024-05-26 00:00:00,161 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id, book_name from book where author_id = ?
2024-05-26 00:00:00,162 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 2(Long)
2024-05-26 00:00:00,162 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,162 INFO (SQLLogger.java:71)- Logic SQL: select id, book_name from book where author_id = ?
2024-05-26 00:00:00,162 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=book, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=book)], parametersIndex=1)), containStar=false, selectListLastPosition=21, groupByLastPosition=0, items=[CommonSelectItem(expression=book_name, alias=Optional.absent()), CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,163 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id, book_name from book where author_id = ? ::: [[2]]
2024-05-26 00:00:00,164 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 1
2024-05-26 00:00:00,165 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ?
2024-05-26 00:00:00,167 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1262260513468559361(Long), 2024-05-25 00:00:00.0(Timestamp), 2024-05-25 23:59:59.999(Timestamp)
2024-05-26 00:00:00,167 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,167 INFO (SQLLogger.java:71)- Logic SQL: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ?
2024-05-26 00:00:00,168 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=user_buy_record, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=user_buy_record)], parametersIndex=3)), containStar=false, selectListLastPosition=31, groupByLastPosition=0, items=[AggregationSelectItem(type=COUNT, innerExpression=(distinct user_id), alias=Optional.absent(), derivedAggregationSelectItems=[], index=-1)], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,168 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select count(distinct user_id) from user_buy_record where book_id = ? and create_time >= ? and create_time <= ? ::: [[1262260513468559361, 2024-05-25 00:00:00.0, 2024-05-25 23:59:59.999]]
2024-05-26 00:00:00,171 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 1
2024-05-26 00:00:00,172 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id from author_income_detail where book_id = ? and income_date = ?
2024-05-26 00:00:00,172 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1262260513468559361(Long), 2024-05-25(Date)
2024-05-26 00:00:00,172 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,173 INFO (SQLLogger.java:71)- Logic SQL: select id from author_income_detail where book_id = ? and income_date = ?
2024-05-26 00:00:00,173 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail)], parametersIndex=2)), containStar=false, selectListLastPosition=10, groupByLastPosition=0, items=[CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,173 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id from author_income_detail where book_id = ? and income_date = ? ::: [[1262260513468559361, 2024-05-25]]
2024-05-26 00:00:00,174 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 0
2024-05-26 00:00:00,176 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,176 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1255060328322027520(Long), 2(Long), 1262260513468559361(Long), 2024-05-25(Date), 0(Integer), 0(Integer), 0(Integer), 2024-05-26 00:00:00.176(Timestamp)
2024-05-26 00:00:00,177 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,177 INFO (SQLLogger.java:71)- Logic SQL: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,177 INFO (SQLLogger.java:71)- SQLStatement: InsertStatement(super=DMLStatement(super=AbstractSQLStatement(type=DML, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[AndCondition(conditions=[])])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail), io.shardingsphere.core.parsing.parser.token.InsertValuesToken@14f9c186], parametersIndex=8)), columns=[Column(name=user_id, tableName=author_income_detail), Column(name=author_id, tableName=author_income_detail), Column(name=book_id, tableName=author_income_detail), Column(name=income_date, tableName=author_income_detail), Column(name=income_account, tableName=author_income_detail), Column(name=income_count, tableName=author_income_detail), Column(name=income_number, tableName=author_income_detail), Column(name=create_time, tableName=author_income_detail)], generatedKeyConditions=[], insertValues=InsertValues(insertValues=[InsertValue(type=VALUES, expression=(?, ?, ?, ?, ?, ?, ?, ?), parametersCount=8)]), columnsListLastPosition=132, generateKeyColumnIndex=-1, insertValuesListLastPosition=165)
2024-05-26 00:00:00,177 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?) ::: [[1255060328322027520, 2, 1262260513468559361, 2024-05-25, 0, 0, 0, 2024-05-26 00:00:00.176]]
2024-05-26 00:00:00,181 DEBUG (BaseJdbcLogger.java:137)- <==    Updates: 1
2024-05-26 00:00:00,183 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ?
2024-05-26 00:00:00,184 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 2(Long), 0(Long), 2024-05-25(Date)
2024-05-26 00:00:00,184 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,185 INFO (SQLLogger.java:71)- Logic SQL: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ?
2024-05-26 00:00:00,186 INFO (SQLLogger.java:71)- SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail)], parametersIndex=3)), containStar=false, selectListLastPosition=10, groupByLastPosition=0, items=[CommonSelectItem(expression=id, alias=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subQueryStatement=null)
2024-05-26 00:00:00,186 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: select id from author_income_detail where author_id = ? and book_id = ? and income_date = ? ::: [[2, 0, 2024-05-25]]
2024-05-26 00:00:00,188 DEBUG (BaseJdbcLogger.java:137)- <==      Total: 0
2024-05-26 00:00:00,191 DEBUG (BaseJdbcLogger.java:137)- ==>  Preparing: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,191 DEBUG (BaseJdbcLogger.java:137)- ==> Parameters: 1255060328322027520(Long), 2(Long), 0(Long), 2024-05-25(Date), 0(Integer), 0(Integer), 0(Integer), 2024-05-26 00:00:00.189(Timestamp)
2024-05-26 00:00:00,192 INFO (SQLLogger.java:71)- Rule Type: sharding
2024-05-26 00:00:00,192 INFO (SQLLogger.java:71)- Logic SQL: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?)
2024-05-26 00:00:00,192 INFO (SQLLogger.java:71)- SQLStatement: InsertStatement(super=DMLStatement(super=AbstractSQLStatement(type=DML, tables=Tables(tables=[Table(name=author_income_detail, alias=Optional.absent())]), conditions=Conditions(orCondition=OrCondition(andConditions=[AndCondition(conditions=[])])), sqlTokens=[TableToken(skippedSchemaNameLength=0, originalLiterals=author_income_detail), io.shardingsphere.core.parsing.parser.token.InsertValuesToken@14f9c186], parametersIndex=8)), columns=[Column(name=user_id, tableName=author_income_detail), Column(name=author_id, tableName=author_income_detail), Column(name=book_id, tableName=author_income_detail), Column(name=income_date, tableName=author_income_detail), Column(name=income_account, tableName=author_income_detail), Column(name=income_count, tableName=author_income_detail), Column(name=income_number, tableName=author_income_detail), Column(name=create_time, tableName=author_income_detail)], generatedKeyConditions=[], insertValues=InsertValues(insertValues=[InsertValue(type=VALUES, expression=(?, ?, ?, ?, ?, ?, ?, ?), parametersCount=8)]), columnsListLastPosition=132, generateKeyColumnIndex=-1, insertValuesListLastPosition=165)
2024-05-26 00:00:00,192 INFO (SQLLogger.java:71)- Actual SQL: ds0 ::: insert into author_income_detail (user_id, author_id, book_id, income_date, income_account, income_count, income_number, create_time) values (?, ?, ?, ?, ?, ?, ?, ?) ::: [[1255060328322027520, 2, 0, 2024-05-25, 0, 0, 0, 2024-05-26 00:00:00.189]]
2024-05-26 00:00:00,196 DEBUG (BaseJdbcLogger.java:137)- <==    Updates: 1
2024-05-26 00:30:31,196 INFO (ExecutorConfigurationSupport.java:208)- Shutting down ExecutorService 'taskScheduler'
2024-05-26 00:30:31,202 INFO (HikariDataSource.java:350)- HikariPool-1 - Shutdown initiated...
2024-05-26 00:30:31,207 INFO (HikariDataSource.java:352)- HikariPool-1 - Shutdown completed.
